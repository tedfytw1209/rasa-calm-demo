version: "3.1"

intents:
  - target_trial_emulation
  - provide_pipeline

slots:
  current_component:
    type: categorical
    values:
      - objectives
      - eligibility
      - treatment_strategies
      - treatment_assignment
      - outcomes
      - follow_up
      - causal_contrasts
      - statistical_analysis
    mappings:
      - type: from_llm
  eligibility_population:
    type: text
    mappings: 
      - type: from_llm
  eligibility_inclusioncriteria:
    type: text
    mappings: 
      - type: from_llm
  eligibility_exclusioncriteria:
    type: text
    mappings: 
      - type: from_llm
  eligibility_computablephenotype:
    type: text
    mappings: 
      - type: from_llm
  eligibility_population_evaluation:
    type: text
    mappings: 
      - type: from_llm
  # Pipeline completion flags
  eligibility_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  objectives_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  treatment_strategies_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  treatment_assignment_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  outcomes_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  follow_up_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  causal_contrasts_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  statistical_analysis_done:
    type: bool
    initial_value: false
    mappings:
      - type: custom
  finish:
    type: bool
    initial_value: false
    mappings:
      - type: custom

responses:
  utter_component_ask:
    - text: "Which component would you like to work on next? Your options are: objectives, eligibility, treatment_strategies, treatment_assignment, outcomes, follow_up, causal_contrasts, statistical_analysis."
  # ---- Eligibility ----
  utter_ask_current_component:
    - text: "Which protocol component do you want to work on now? For example: eligibility, treatment_assignment, outcomes, follow_up, etc."
  utter_ask_eligibility_population:
    - text: "Please describe the target population for your studyâ€™s eligibility criteria."
  utter_ask_eligibility_inclusioncriteria:
    - text: "Please list the inclusion criteria for your study."
  utter_ask_eligibility_exclusioncriteria:
    - text: "Please list the exclusion criteria for your study."
  utter_ask_eligibility_computablephenotype:
    - text: "Please describe the computable phenotype (codes/algorithms) that define eligibility."
  utter_ask_eligibility_population_evaluation:
    - text: "How will you evaluate or validate that your population definition works as intended?"

actions:
  - action_mark_component_done
  - action_check_finish_pipeline
  - action_export_protocol_json
